name: ghcr-cleanup
on:
  workflow_dispatch:           
  schedule:
    - cron: "0 3 * * 0"        

permissions:
  packages: write              # allow deleting package versions

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/delete-package-versions@v5
        with:
          package-type: container
          package-name: aws-devops-pipeline-demo/app   # lower-case image path after ghcr.io/<owner>/
          min-versions-to-keep: 3                      # keep newest 3 tags, delete older ones
